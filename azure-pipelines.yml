# Node.js with React
# Build a Node.js project that uses React.
# Add steps that analyze code, save build artifacts, deploy, and more:
# https://docs.microsoft.com/azure/devops/pipelines/languages/javascript

trigger:
- master

pool:
  vmImage: 'ubuntu-latest'

steps:
- task: NodeTool@0
  inputs:
    versionSpec: '10.x'
  displayName: '1. Install Node.js'

- script: |
    npm install
    npm run build
  displayName: '2. npm install and build'

- script: docker build -f Dockerfile -t achauncey/frontend-protutorials .
  displayName: '3. create docker container'

- script: docker save -o latestversion$(Build.SourceVersion).tar achauncey/frontend-protutorials
  displayName: '3. create docker container'

- task: PublishBuildArtifacts@1
  inputs:
    PathtoPublish: '$(Build.ArtifactStagingDirectory)/latestversion$(Build.SourceVersion).tar'
    ArtifactName: 'docker-frontend'
    publishLocation: 'Container'